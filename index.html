<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radar des Financements | Emergence OI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Action-Oriented Dashboard -> Background: #f8fafc (Slate 50), Text: #0f172a (Slate 900), Accents: #2563eb (Blue - Trust/Finance), #dc2626 (Red - Urgent), #16a34a (Green - Match) -->
    
    <!-- Application Structure Plan: 
         1. Header: Contextualizes the tool (Feb-Apr 2026 timeframe).
         2. KPIs Overview: Quick summary of open funds and average match score.
         3. Main Layout (Two-Column): 
            - Left: Interactive, ranked list of AAPs (Appels √† Projets) sorted by urgency and match score.
            - Right: Detail Panel ("Note du Consultant"). Shows the strategic analysis, Go/No-Go advice, and resource assessment for the selected AAP.
         4. Interaction: Clicking a list item updates the detail panel dynamically without reloading, allowing fast review of opportunities.
    -->

    <!-- Visualization & Content Choices:
         1. Status Indicators (HTML/CSS): Colored dots to indicate urgency (Red=Today, Orange=Soon, Green=Rolling). Goal: Drive action.
         2. Match Score Bar (HTML/CSS): Visual representation of how well the AAP fits Emergence OI's DNA. Goal: Prioritization.
         3. Radar Chart in Detail Panel (Chart.js): Visualizes the alignment of the specific AAP against our 4 strategic axes. Goal: Quick strategic check.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #0f172a; overflow-x: hidden; }
        .aap-card { transition: all 0.2s ease; border-left: 4px solid transparent; }
        .aap-card:hover { background-color: #f1f5f9; cursor: pointer; }
        .aap-card.selected { background-color: #eff6ff; border-left-color: #2563eb; box-shadow: inset 0 2px 4px 0 rgb(0 0 0 / 0.05); }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
            height: 250px;
        }
        
        /* Custom Scrollbar for the list */
        .scrollable-list::-webkit-scrollbar { width: 6px; }
        .scrollable-list::-webkit-scrollbar-track { background: transparent; }
        .scrollable-list::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-slate-900 text-white shadow-md z-10 shrink-0">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold tracking-tight">Radar des Financements <span class="text-blue-400">Emergence OI</span></h1>
                <p class="text-slate-400 text-sm mt-1">Fen√™tre de tir : 27 F√©vrier - Fin Avril 2026 | Mode : Assistant Pro activ√©</p>
            </div>
            <div class="hidden md:flex gap-4">
                <div class="bg-slate-800 px-4 py-2 rounded-lg text-center">
                    <div class="text-xs text-slate-400 uppercase tracking-wider font-semibold">Opportunit√©s Identifi√©es</div>
                    <div class="text-xl font-bold text-blue-400">5</div>
                </div>
                <div class="bg-slate-800 px-4 py-2 rounded-lg text-center">
                    <div class="text-xs text-slate-400 uppercase tracking-wider font-semibold">Score Moyen d'Ad√©quation</div>
                    <div class="text-xl font-bold text-green-400">82%</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow flex overflow-hidden max-w-7xl mx-auto w-full">
        
        <!-- Left Column: AAP List -->
        <section class="w-full md:w-1/3 lg:w-2/5 bg-white border-r border-slate-200 flex flex-col">
            <div class="p-4 border-b border-slate-200 bg-slate-50 flex justify-between items-center shrink-0">
                <h2 class="font-semibold text-slate-800">Appels √† Projets (AAP) & Aides</h2>
                <span class="text-xs bg-slate-200 text-slate-600 px-2 py-1 rounded-full font-medium">Trier par: Urgence</span>
            </div>
            
            <div class="overflow-y-auto flex-grow scrollable-list" id="aap-list">
                <!-- List items injected by JS -->
            </div>
        </section>

        <!-- Right Column: Detail Panel (Consultant View) -->
        <section class="hidden md:flex md:w-2/3 lg:w-3/5 bg-slate-50 flex-col overflow-y-auto" id="detail-panel">
            <!-- Default Empty State -->
            <div id="empty-state" class="h-full flex flex-col items-center justify-center text-slate-400 p-8 text-center">
                <div class="text-6xl mb-4">üéØ</div>
                <h3 class="text-xl font-semibold text-slate-600 mb-2">Pr√™t √† analyser</h3>
                <p class="max-w-md">S√©lectionne une opportunit√© dans la liste √† gauche pour afficher mon analyse strat√©gique, notre angle d'attaque et mes recommandations.</p>
            </div>

            <!-- Content State (Hidden by default) -->
            <div id="content-state" class="hidden flex-col p-6 lg:p-8">
                
                <!-- Meta Info -->
                <div class="flex justify-between items-start mb-6">
                    <div>
                        <div class="flex items-center gap-2 mb-2" id="detail-tags">
                            <!-- Tags injected here -->
                        </div>
                        <h2 class="text-3xl font-bold text-slate-900 leading-tight" id="detail-title">Titre AAP</h2>
                        <p class="text-slate-500 font-medium mt-2" id="detail-sponsor">Financeur</p>
                    </div>
                    <div class="text-right shrink-0 bg-white p-3 rounded-xl border border-slate-200 shadow-sm">
                        <div class="text-xs text-slate-500 uppercase font-bold mb-1">√âch√©ance</div>
                        <div class="text-lg font-bold" id="detail-deadline">Date</div>
                    </div>
                </div>

                <!-- Core Analysis Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    
                    <!-- Consultant Note -->
                    <div class="bg-white rounded-xl p-6 border border-slate-200 shadow-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-blue-500"></div>
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center"><span class="mr-2">üí°</span> Mon Analyse Strat√©gique</h3>
                        <p class="text-slate-600 text-sm leading-relaxed mb-4" id="detail-analysis">
                            Analyse text here.
                        </p>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="text-xs font-bold text-blue-800 uppercase mb-2">Notre Angle d'Attaque (Pitch)</h4>
                            <p class="text-blue-900 text-sm italic" id="detail-pitch">Pitch text here.</p>
                        </div>
                    </div>

                    <!-- Alignment Chart -->
                    <div class="bg-white rounded-xl p-6 border border-slate-200 shadow-sm flex flex-col">
                        <h3 class="font-bold text-slate-800 mb-1 flex items-center"><span class="mr-2">üß≠</span> Alignement avec nos Axes</h3>
                        <p class="text-xs text-slate-500 mb-4">√Ä quel point cet AAP finance notre c≈ìur de m√©tier ?</p>
                        <div class="flex-grow flex items-center justify-center">
                            <div class="chart-container">
                                <canvas id="alignmentChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pragmatic Assessment -->
                <h3 class="font-bold text-slate-800 mb-4 text-lg border-b border-slate-200 pb-2">√âvaluation Pragmatique</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                    <div class="bg-white p-4 rounded-xl border border-slate-200">
                        <div class="text-slate-400 text-2xl mb-2">‚öôÔ∏è</div>
                        <h4 class="font-bold text-sm text-slate-700 mb-1">Faisabilit√© Op√©rationnelle</h4>
                        <p class="text-sm text-slate-600" id="detail-feasibility">High</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-slate-200">
                        <div class="text-slate-400 text-2xl mb-2">‚ö†Ô∏è</div>
                        <h4 class="font-bold text-sm text-slate-700 mb-1">Points de Vigilance</h4>
                        <ul class="text-sm text-slate-600 list-disc pl-4 space-y-1" id="detail-risks">
                            <!-- Risks injected here -->
                        </ul>
                    </div>
                    <div class="bg-slate-800 text-white p-4 rounded-xl shadow-md flex flex-col justify-between" id="detail-decision-card">
                        <div>
                            <div class="text-2xl mb-2" id="detail-decision-icon">üö¶</div>
                            <h4 class="font-bold text-sm mb-1 text-slate-300">Recommandation</h4>
                            <p class="font-bold text-lg" id="detail-decision">GO</p>
                        </div>
                        <button class="w-full mt-4 bg-white text-slate-900 py-2 rounded text-sm font-bold hover:bg-slate-100 transition">
                            Pr√©parer le dossier
                        </button>
                    </div>
                </div>

            </div>
        </section>
        
        <!-- Mobile Placeholder for Details (Simplification for single file logic) -->
        <div id="mobile-alert" class="md:hidden fixed bottom-0 left-0 w-full bg-slate-800 text-white p-4 text-center text-sm z-50 transform translate-y-full transition-transform duration-300">
            Faites pivoter votre appareil ou utilisez une tablette/PC pour voir l'analyse d√©taill√©e du consultant.
        </div>
    </main>

    <script>
        // --- DATA ---
        // Simulated AAP data based on real 2026/typical context in La R√©union
        const aaps = [
            {
                id: 'aap-1',
                title: 'AMI FSE+ "Dispositifs de la deuxi√®me chance"',
                sponsor: 'R√©gion R√©union / FSE+',
                deadline: '27 F√©vrier 2026 (12h)',
                urgency: 'critical', // critical, warning, normal
                matchScore: 95,
                tags: ['Inclusion', 'Formation'],
                axes: [80, 100, 30, 70], // [Num√©rique, Inclusion, Culture, Territoire]
                analysis: "C'est exactement notre c≈ìur de cible pour le programme 'Croire au Potentiel de Chacun'. Cet AMI finance la remise en parcours des jeunes √©loign√©s de l'emploi (NEETs). Les fonds FSE+ sont lourds administrativement, mais ce sont ceux qui financent le mieux la masse salariale des accompagnateurs sociaux et formateurs.",
                pitch: "Positionner 'Croire au Potentiel de Chacun' comme un sas de remobilisation innovant utilisant le FabLab (faire pour reprendre confiance) avant l'orientation vers nos formations certifiantes (PIX).",
                feasibility: "Ressources internes pr√™tes, programme d√©j√† rod√©. Reste √† monter le budget FSE.",
                risks: ["Cl√¥ture AUJOURD'HUI. Si on n'a pas d√©j√† commenc√©, c'est mort pour cette session.", "Lourdeur du reporting FSE (fiches de temps obligatoires)."],
                decision: "NO-GO (Trop tard) ou ALL-IN (Si dossier pr√©-rempli). Viser la prochaine rel√®ve.",
                decisionColor: "bg-red-900"
            },
            {
                id: 'aap-2',
                title: 'AAP EDD "Climat, nos actions pour notre √Æle"',
                sponsor: 'DEAL R√©union',
                deadline: '3 Avril 2026',
                urgency: 'warning',
                matchScore: 88,
                tags: ['Territoire', 'Scolaire', 'Num√©rique'],
                axes: [70, 50, 40, 90],
                analysis: "Tr√®s belle opportunit√© pour lier notre expertise technique (FabLab) √† un enjeu de soci√©t√©, ce qui pla√Æt √©norm√©ment aux financeurs actuels. La DEAL veut des actions concr√®tes d'adaptation ou d'att√©nuation. C'est parfait pour financer des interventions dans les √©coles ou des ateliers grand public.",
                pitch: "Proposer un programme 'Makers pour le Climat' : Ateliers dans les coll√®ges/lyc√©es pour prototyper des solutions locales (ex: capteurs CO2 avec Arduino, recyclage plastique en 3D) coupl√© √† 'Racine & Pixels'.",
                feasibility: "Tr√®s bonne. Nous avons l'√©quipement (FabLab) et les comp√©tences d'animation. Demande juste une ing√©nierie p√©dagogique orient√©e 'climat'.",
                risks: ["Ne pas faire de 'greenwashing'. Le projet doit avoir un impact mesurable sur l'√©ducation au DD.", "Budget souvent plafonn√©, ne financera pas de gros investissements mat√©riels."],
                decision: "GO ABSOLU. Priorit√© du mois de mars.",
                decisionColor: "bg-green-700"
            },
            {
                id: 'aap-3',
                title: 'Appel √† Projets "Fondation pour l\'Inclusion"',
                sponsor: 'Fondation d\'Entreprise (Priv√©)',
                deadline: '15 Avril 2026',
                urgency: 'normal',
                matchScore: 75,
                tags: ['Inclusion', 'Jeunesse'],
                axes: [50, 90, 40, 60],
                analysis: "Contrairement aux fonds publics, les fondations priv√©es financent de l'innovation et de l'exp√©rimentation avec beaucoup moins de lourdeur administrative. Elles cherchent l'impact direct sur les b√©n√©ficiaires.",
                pitch: "Demander un co-financement pour nos stages 'Tech'exploreur' destin√©s aux jeunes de quartiers prioritaires (QPV), en insistant sur la r√©duction de la fracture num√©rique et l'√©galit√© des chances.",
                feasibility: "Excellente. Le formalisme est all√©g√© (souvent un dossier de 10 pages maximum).",
                risks: ["Les montants sont souvent plus faibles (10k‚Ç¨ - 20k‚Ç¨).", "Forte concurrence. Il faut un dossier tr√®s 'storytelling' et visuel."],
                decision: "GO. Id√©al pour diversifier nos revenus et sortir du 100% public.",
                decisionColor: "bg-green-700"
            },
            {
                id: 'aap-4',
                title: 'Kap Num√©rik 2026',
                sponsor: 'R√©gion R√©union',
                deadline: 'Fil de l\'eau (Continu)',
                urgency: 'normal',
                matchScore: 60,
                tags: ['Num√©rique', 'Fonctionnement'],
                axes: [100, 20, 20, 30],
                analysis: "Ce n'est pas pour financer nos actions vers les publics, mais pour financer NOTRE propre transformation num√©rique ou pour accompagner nos structures partenaires (associations h√©berg√©es au coworking) √† le faire. Aide de 3200‚Ç¨ max (80% des d√©penses).",
                pitch: "Utiliser cette aide pour refondre le site web d'Emergence OI, int√©grer un module de r√©servation en ligne pour le FabLab et le M√©dialab, ou renforcer notre cybers√©curit√©.",
                feasibility: "Formalit√© administrative simple via la plateforme r√©gionale.",
                risks: ["Plafond bas (3200‚Ç¨).", "Il faut avancer les frais avant le remboursement."],
                decision: "√Ä GARDER SOUS LE COUDE. √Ä activer quand on a un devis prestataire pr√™t.",
                decisionColor: "bg-slate-700"
            },
            {
                id: 'aap-5',
                title: 'Dispositif Gu√©tali 2025-2026',
                sponsor: 'R√©gion R√©union',
                deadline: 'Session en cours',
                urgency: 'normal',
                matchScore: 70,
                tags: ['Culture', 'Territoire'],
                axes: [20, 40, 100, 80],
                analysis: "Le dispositif phare de la R√©gion pour la diffusion culturelle. Bien que nous ne soyons pas une compagnie de th√©√¢tre, nous sommes un Tiers-Lieu qui accueille des r√©sidences d'artistes. Nous pouvons nous positionner comme structure d'accueil ou partenaire technique.",
                pitch: "S'associer avec des artistes locaux √©ligibles au Gu√©tali pour qu'ils cr√©ent/diffusent au sein de notre M√©dialab ou FabLab, cr√©ant ainsi des rencontres improbables avec nos publics en insertion.",
                feasibility: "Demande un partenariat fort avec des artistes d√©j√† structur√©s (SIRET, URSSAF). Nous ne porterions pas forc√©ment le dossier seuls.",
                risks: ["D√©pendance vis-√†-vis des artistes partenaires.", "Les d√©lais de validation de la R√©gion peuvent √™tre longs."],
                decision: "GO CONDITIONNEL. Si on identifie les bons artistes partenaires.",
                decisionColor: "bg-orange-600"
            }
        ];

        let chartInstance = null;

        // --- CORE FUNCTIONS ---

        document.addEventListener('DOMContentLoaded', () => {
            renderList();
            
            // Show mobile alert if viewing on small screen
            if(window.innerWidth < 768) {
                const alert = document.getElementById('mobile-alert');
                alert.classList.remove('translate-y-full');
                setTimeout(() => alert.classList.add('translate-y-full'), 4000);
            }
        });

        function renderList() {
            const listContainer = document.getElementById('aap-list');
            listContainer.innerHTML = '';

            aaps.forEach(aap => {
                // Urgency styling
                let dotColor = 'bg-slate-400';
                let textColor = 'text-slate-500';
                if(aap.urgency === 'critical') { dotColor = 'bg-red-500 animate-pulse'; textColor = 'text-red-600'; }
                else if(aap.urgency === 'warning') { dotColor = 'bg-orange-500'; textColor = 'text-orange-600'; }
                else if(aap.urgency === 'normal') { dotColor = 'bg-green-500'; textColor = 'text-green-600'; }

                // Match score color logic
                let scoreColor = 'bg-green-500';
                if(aap.matchScore < 70) scoreColor = 'bg-orange-400';
                if(aap.matchScore < 50) scoreColor = 'bg-red-400';

                const card = document.createElement('div');
                card.className = `aap-card p-4 border-b border-slate-100`;
                card.dataset.id = aap.id;
                card.onclick = () => selectAAP(aap.id);

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full ${dotColor}"></span>
                            <span class="text-xs font-bold ${textColor}">${aap.deadline}</span>
                        </div>
                        <span class="text-xs font-bold px-2 py-0.5 rounded bg-slate-100 text-slate-600">${aap.matchScore}% Match</span>
                    </div>
                    <h3 class="font-bold text-slate-800 text-sm mb-1 leading-tight">${aap.title}</h3>
                    <p class="text-xs text-slate-500 mb-3">${aap.sponsor}</p>
                    
                    <div class="w-full bg-slate-200 rounded-full h-1.5 mb-2">
                        <div class="${scoreColor} h-1.5 rounded-full" style="width: ${aap.matchScore}%"></div>
                    </div>
                    
                    <div class="flex gap-1 flex-wrap">
                        ${aap.tags.map(tag => `<span class="text-[10px] uppercase tracking-wider font-semibold text-blue-700 bg-blue-50 px-1.5 py-0.5 rounded">${tag}</span>`).join('')}
                    </div>
                `;
                listContainer.appendChild(card);
            });
        }

        function selectAAP(id) {
            // UI Selection state
            document.querySelectorAll('.aap-card').forEach(c => c.classList.remove('selected'));
            document.querySelector(`.aap-card[data-id="${id}"]`).classList.add('selected');

            // Find data
            const aap = aaps.find(a => a.id === id);
            if(!aap) return;

            // Toggle views
            document.getElementById('empty-state').classList.add('hidden');
            document.getElementById('content-state').classList.remove('hidden');
            document.getElementById('content-state').classList.add('flex');

            // Populate Content
            document.getElementById('detail-title').textContent = aap.title;
            document.getElementById('detail-sponsor').textContent = aap.sponsor;
            
            let deadlineColor = aap.urgency === 'critical' ? 'text-red-600' : 'text-slate-800';
            document.getElementById('detail-deadline').innerHTML = `<span class="${deadlineColor}">${aap.deadline}</span>`;
            
            document.getElementById('detail-analysis').textContent = aap.analysis;
            document.getElementById('detail-pitch').textContent = aap.pitch;
            document.getElementById('detail-feasibility').textContent = aap.feasibility;
            
            // Populate Tags
            const tagsContainer = document.getElementById('detail-tags');
            tagsContainer.innerHTML = aap.tags.map(tag => `<span class="px-2 py-1 bg-slate-200 text-slate-700 text-xs font-bold rounded-md">${tag}</span>`).join('');

            // Populate Risks
            const risksContainer = document.getElementById('detail-risks');
            risksContainer.innerHTML = aap.risks.map(risk => `<li>${risk}</li>`).join('');

            // Populate Decision Card
            document.getElementById('detail-decision').textContent = aap.decision;
            const decisionCard = document.getElementById('detail-decision-card');
            // Reset colors
            decisionCard.className = `text-white p-4 rounded-xl shadow-md flex flex-col justify-between ${aap.decisionColor}`;
            document.getElementById('detail-decision-icon').textContent = aap.decisionColor.includes('red') ? 'üõë' : (aap.decisionColor.includes('green') ? 'üöÄ' : 'ü§î');

            // Update Chart
            updateChart(aap.axes);
        }

        function updateChart(dataAxes) {
            const ctx = document.getElementById('alignmentChart').getContext('2d');
            
            if(chartInstance) {
                chartInstance.data.datasets[0].data = dataAxes;
                chartInstance.update();
                return;
            }

            chartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Num√©rique', 'Inclusion', 'Culture', 'Territoire'],
                    datasets: [{
                        label: 'Alignement (%)',
                        data: dataAxes,
                        backgroundColor: 'rgba(37, 99, 235, 0.2)', // Blue 600 with opacity
                        borderColor: '#2563eb',
                        pointBackgroundColor: '#2563eb',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#2563eb',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0,0,0,0.1)' },
                            grid: { color: 'rgba(0,0,0,0.05)' },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: { display: false, stepSize: 20 },
                            pointLabels: {
                                font: { family: 'Inter', size: 11, weight: '600' },
                                color: '#475569'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            padding: 10,
                            callbacks: {
                                label: function(context) {
                                    return ` Alignement: ${context.raw}%`;
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
